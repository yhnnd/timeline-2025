Dec 03, 2025

学习笔记 3 优化魔盒操作界面的脚本

let pin1 = document.querySelector(".jx-composite-panel-tabs-header-pin");
pin1 && pin1.click();
let pin2 = document.querySelector(".jx-settings-panel-header-pin");
pin2 && pin2.click();
let style = document.createElement("style");
style.innerHTML = `.jx-composite-panel-tabs-content {width: 512px}
.jx-composite-panel-tabs-header-pin-filled, .jx-settings-panel-pin-filled {display: none}
.jx-main-panel-header-actions .ant-space.ant-space-horizontal {margin-right: 51px !important}
.jx-main-panel-header-actions .ant-space.ant-space-horizontal .ant-space-item:last-child {margin-left: 135px}
.ant-btn-group.jx-view-tools {position: fixed;top: 13px;right: 125px;transform: scale(1.5);}
.ant-btn-group.jx-view-tools .ant-btn:not([disabled]) {background: unset;color: white;border-color: transparent;}
.jx-settings-panel-opener {background: unset;color: white;border: unset;position: fixed;right: 0;top: 0;transform: unset;width: 50px;height: 50px;}`;
document.body.append(style);

Dec 04, 2025

学习笔记 4 优化魔盒操作界面的脚本(新)

let pin1 = document.querySelector(".ant-composite-panel-tabs-header-pin");
pin1 && pin1.click();
let pin2 = document.querySelector(".ant-settings-panel-header-pin");
pin2 && pin2.click();
let style = document.createElement("style");
style.innerHTML = `.ant-composite-panel-tabs-content {width: 512px}
.ant-composite-panel-tabs-header-pin-filled, .ant-settings-panel-pin-filled, .i-icon-smart-optimization {display: none}
.ant-main-panel-header-actions {margin-right: 40px !important}
.ant-main-panel-header-actions .ant-space-item:last-child {margin-left: 135px}
.ant-view-tools {position: fixed;top: 13px;right: 139px;transform: scale(1.5);}
.ant-view-tools .ant-btn:not([disabled]) {background: unset;color: white;border-color: transparent;}
.ant-settings-panel-opener {background: unset;color: white;border: unset;position: fixed;right: 0;top: 0;transform: unset;width: 50px;height: 50px;}
.ant-btn-circle:has(.i-icon-smart-optimization) {display: none}`;
document.body.append(style);

Chrome 专用的魔盒优化插件

manifest.json

{
  "manifest_version": 3,
  "version": "1.0.0",
  "name": "魔盒优化插件",
  "description": "Chrome 专用的魔盒优化插件 v1.0.0 by 于海宁",
  "permissions": ["*://magicbox.jdtest.net/*"],
  "content_scripts": [{
    "matches": ["*://magicbox.jdtest.net/*"],
    "js": ["inject.js"],
    "run_at": "document_end",
    "all_frames": true
  }]
}

inject.js

let style = document.createElement("style");
style.innerHTML = `.jx-composite-panel-tabs-content, .jx-settings-panel,
.ant-composite-panel-tabs-content, .ant-settings-panel {width: 512px;outline: 5px solid red;}

.jx-main-panel-header-actions .ant-space.ant-space-horizontal {margin-right: 51px !important}
.ant-main-panel-header-actions {margin-right: 40px !important}

.jx-main-panel-header-actions .ant-space.ant-space-horizontal .ant-space-item:last-child,
.ant-main-panel-header-actions .ant-space-item:last-child {margin-left: 135px}

.jx-view-tools {position: fixed;top: 13px;right: 125px;transform: scale(1.5);}
.ant-view-tools {position: fixed;top: 13px;right: 139px;transform: scale(1.5);}

.jx-view-tools .ant-btn[disabled],
.ant-view-tools .ant-btn[disabled] {color: black}

.jx-view-tools .ant-btn:not([disabled]),
.ant-view-tools .ant-btn:not([disabled]) {background: unset;color: white;border-color: transparent;}

.jx-settings-panel-opener,
.ant-settings-panel-opener,
.jx-settings-panel-header-close,
.ant-settings-panel-header-close {background: unset;color: white;border: unset;position: fixed;right: 0;top: 0;transform: unset;width: 50px;height: 50px;}

.jx-settings-panel-header-close,
.ant-settings-panel-header-close {display: flex;justify-content: center;align-items: center;}

.jx-composite-panel-tabs-header-close:hover, .jx-settings-panel-header-close:hover,
.ant-composite-panel-tabs-header-close:hover, .ant-settings-panel-header-close:hover {transform: unset}

.jx-btn-circle:has(.i-icon-smart-optimization),
.ant-btn-circle:has(.i-icon-smart-optimization) {display: none}

.jx-main-panel-header,
.ant-main-panel-header {
  background-image: linear-gradient(to right, black, rgb(3, 105, 161), rgb(56, 189, 248), rgb(30, 64, 175), black, rgb(3, 105, 161), rgb(56, 189, 248), rgb(30, 64, 175), black);
  background-repeat: repeat-x;
  background-position: 0 0;
  background-size: 200% 100%;
}

@keyframes bg {
  from {
    background-position: 0 0;
  }
  to {
    background-position: 200% 0;
  }
}

body:has(.jx-view-tools > button:last-child[disabled]) .jx-main-panel-header,
body:has(.ant-view-tools > button:last-child[disabled]) .ant-main-panel-header {animation: bg 60s infinite linear;}

.jx-composite-panel-tabs-content:not(:has(.jx-outline-tree-container)) .btn-collapse-all-nodes,
.ant-composite-panel-tabs-content:not(:has(.ant-outline-tree-container)) .btn-collapse-all-nodes {display: none}

.jx-resource-item-text,
.ant-resource-item-text,
.jx-outline-tree-node-title,
.ant-outline-tree-node-title {font-size: 16px;color: black;font-weight: bold;}

.jx-settings-form-wrapper .jx-formily-item *,
.ant-settings-form-wrapper .ant-formily-item * {font-size: 16px;}

.jx-formily-item-label[style*="width: 120px;"][style*="max-width: 120px;"],
.ant-formily-item-label[style*="width: 120px;"][style*="max-width: 120px;"] {
  width: unset!important;
  max-width: unset!important;
}

.jx-formily-item-label-content,
.ant-formily-item-label-content {font-weight: bold;}

.jx-drawer-right .jx-drawer-content-wrapper[style*="width: 300px;"],
.ant-drawer-right .ant-drawer-content-wrapper[style*="width: 300px;"] {width: 512px!important;}

.jx-drawer-right .jx-drawer-content-wrapper,
.ant-drawer-right .ant-drawer-content-wrapper {width: 100%!important;}

.jsonata-editor .jx-drawer-body > .SplitPane,
.jsonata-editor .ant-drawer-body > .SplitPane {max-height: calc(100vh - 70px);}

.jsonata-editor .jx-drawer-body > .SplitPane > .Pane1,
.jsonata-editor .ant-drawer-body > .SplitPane > .Pane1 {width: 100%!important;}

.jsonata-editor .jx-drawer-body > .SplitPane > .Pane2,
.jsonata-editor .ant-drawer-body > .SplitPane > .Pane2 {display: none}

.jx-drawer-left.ant-drawer-open, .jx-drawer-right.ant-drawer-open,
.ant-drawer-left.ant-drawer-open, .ant-drawer-right.ant-drawer-open {transition: none;animation: none;}

.jx-drawer.ant-drawer-open .jx-drawer-mask,
.ant-drawer.ant-drawer-open .ant-drawer-mask {transition: none;animation: none;}

.jx-drawer,
.ant-drawer {transition: none;animation: none;}

.jx-drawer-mask,
.ant-drawer-mask {transition: none;animation: none;}

.jx-drawer-content-wrapper,
.ant-drawer-content-wrapper {transition: none;animation: none;}

.jx-settings-form .jx-btn-link,
.ant-settings-form .ant-btn-link,
.jx-formily-item-control-content-component .jx-btn-link,
.ant-formily-item-control-content-component .ant-btn-link {border: 1px solid;border-radius: 6px;margin-top: 16px;margin-bottom:16px;}

.jx-select-focused.jx-select-open,
.ant-select-focused.ant-select-open {outline: 3px solid green}

.jx-select.jx-tree-select.jx-select-multiple[style*="min-width: 200px;"],
.ant-select.ant-tree-select.ant-select-multiple[style*="min-width: 200px;"] {min-width: 500px!important;}

.jx-select-dropdown,
.ant-select-dropdown {
  position: fixed!important;
  left: 0!important;
  min-width: 100vw!important;
  width: 100vw!important;
  max-width: 100vw!important;
  transition: unset!important;
  transform: unset!important;
  opacity: unset!important;
  animation-duration: unset;
  border: 5px solid red;
}

.jx-select-dropdown.jx-tree-select-dropdown,
.ant-select-dropdown.ant-tree-select-dropdown {
  top: 0!important;
  min-width: calc(100vw - 200px) !important;
  width: calc(100vw - 200px) !important;
  max-width: calc(100vw - 200px) !important;
  max-height: calc(100vh - 60px) !important;
}

.jx-slide-up-leave, .jx-slide-up-leave.jx-slide-up-leave-active,
.ant-slide-up-leave, .ant-slide-up-leave.ant-slide-up-leave-active {
  animation-duration: 1ms;
}

body:has(.jx-select-dropdown:not(.jx-select-dropdown-hidden)) .jx-main-panel-container.root,
body:has(.jx-select-dropdown:not(.jx-select-dropdown-hidden)) .jx-drawer-content-wrapper,
body:has(.ant-select-dropdown:not(.ant-select-dropdown-hidden)) .ant-main-panel-container.root,
body:has(.ant-select-dropdown:not(.ant-select-dropdown-hidden)) .ant-drawer-content-wrapper {
  filter: brightness(.9);
}

.jx-select-dropdown.jx-tree-select-dropdown .jx-select-tree,
.ant-select-dropdown.ant-tree-select-dropdown .ant-select-tree {
  position: fixed!important;
  left: 0!important;
  top: 0!important;
  min-width: calc(100vw - 200px) !important;
  min-height: unset!important;
  color: black;
  transition: none!important;
}

.jx-select-tree-list-holder,
.ant-select-tree-list-holder {max-height: calc(100vh - 60px) !important;border: 5px solid red;transition: none!important;}

.jx-settings-form .jx-row:has(> .jx-col:nth-child(3)):has(> .jx-col:nth-child(2) .jsonata-editor),
.ant-settings-form .ant-row:has(> .ant-col:nth-child(3)):has(> .ant-col:nth-child(2) .jsonata-editor) {
  display: block;
  position: relative;
}

.jx-settings-form .jx-row:has(> .jx-col:nth-child(3)):has(> .jx-col:nth-child(2) .jsonata-editor) > .jx-col:first-child,
.ant-settings-form .ant-row:has(> .ant-col:nth-child(3)):has(> .ant-col:nth-child(2) .jsonata-editor) > .ant-col:first-child {
  font-weight: bold;
  font-size: 16px;
  margin-bottom: 16px;
}

.jx-settings-form .jx-row:has(> .jx-col:nth-child(3)):has(> .jx-col:nth-child(2) .jsonata-editor) > .jx-col:last-child:has([aria-label="delete"]),
.ant-settings-form .ant-row:has(> .ant-col:nth-child(3)):has(> .ant-col:nth-child(2) .jsonata-editor) > .ant-col:last-child:has([aria-label="delete"]) {
  position: absolute;
  right: 0;
  top: 0;
}

.jx-settings-form .jx-row:has(> .jx-col:nth-child(3)):has(> .jx-col:nth-child(2) .jsonata-editor) .monaco-editor,
.ant-settings-form .ant-row:has(> .ant-col:nth-child(3)):has(> .ant-col:nth-child(2) .jsonata-editor) .monaco-editor {
  width: 100% !important;
  height: 100% !important;
  animation: none !important;
  transition: none !important;
}

.jx-settings-form .jx-row:has(> .jx-col:nth-child(3)):has(> .jx-col:nth-child(2) .jsonata-editor) .monaco-editor .overflow-guard,
.ant-settings-form .ant-row:has(> .ant-col:nth-child(3)):has(> .ant-col:nth-child(2) .jsonata-editor) .monaco-editor .overflow-guard {
  width: 100% !important;
  height: 100% !important;
  animation: none !important;
  transition: none !important;
}
`;
document.body.append(style);

setTimeout(() => {
let collapseButtonClicked = function () {
    document.querySelectorAll(".jx-outline-tree-node-children > .jx-outline-tree-node.expanded > .jx-outline-tree-node-header .jx-outline-tree-node-expand").forEach(expand => { expand.click(); });
    document.querySelectorAll(".ant-outline-tree-node-children > .ant-outline-tree-node.expanded > .ant-outline-tree-node-header .ant-outline-tree-node-expand").forEach(expand => { expand.click(); });
}
let addCollapseBtn = function () {
    const btn = document.createElement("span");
    btn.classList.add("btn-collapse-all-nodes");
    btn.innerText = "Collapse";
    btn.style.cssText = "color: black;border: 1px solid black;border-radius: 8px;padding: 4px 8px;cursor: pointer;";
    btn.addEventListener("click", collapseButtonClicked);
    setTimeout(function () {
        if (!document.querySelector(".jx-composite-panel-tabs-header-actions > .btn-collapse-all-nodes, .ant-composite-panel-tabs-header-actions > .btn-collapse-all-nodes")) {
            document.querySelector(".jx-composite-panel-tabs-header-actions, .ant-composite-panel-tabs-header-actions")?.prepend(btn);
        }
    }, 100);
}
addCollapseBtn();
document.querySelector(".jx-composite-panel-tabs-pane:has(.i-icon-layers), .ant-composite-panel-tabs-pane:has(.i-icon-layers)")?.addEventListener("click", addCollapseBtn);
console.log("魔盒优化插件脚本已成功注入并执行！");
document.title = "已被插件优化 - " + document.title;
}, 1000);
